<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Anime List</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 20px;
        background: #f4f4f4;
    }
    h1 {
        text-align: center;
    }
    table {
        border-collapse: collapse;
        width: 100%;
        background: white;
    }
    th, td {
        padding: 8px 12px;
        border: 1px solid #ccc;
    }
    th {
        background: #333;
        color: white;
        cursor: pointer;
    }
    tr:nth-child(even) {
        background: #f9f9f9;
    }
    #search {
        margin-bottom: 10px;
        padding: 8px;
        width: 100%;
        font-size: 16px;
    }
</style>
</head>
<body>

<h1>Anime List</h1>
<input type="text" id="search" placeholder="Search anime...">

<table id="animeTable">
    <thead>
        <tr>
            <th onclick="sortTable(0)">Name</th>
            <th onclick="sortTable(1)">ID</th>
            <th>Link</th>
        </tr>
    </thead>
    <tbody></tbody>
</table>

<script>
async function loadAnimeFiles() {
    const files = [
        'merged_anime_list_part1.json',
        'merged_anime_list_part2.json',
        'merged_anime_list_part3.json',
        'merged_anime_list_part4.json',
        'merged_anime_list_part5.json'
    ];

    let allAnime = [];
    for (const file of files) {
        const res = await fetch(file);
        const data = await res.json();
        allAnime = allAnime.concat(data);
    }
    return allAnime;
}

function renderTable(data) {
    const tbody = document.querySelector('#animeTable tbody');
    tbody.innerHTML = '';
    data.forEach(anime => {
        const row = document.createElement('tr');
        row.innerHTML = `
            <td>${anime.name}</td>
            <td>${anime.id}</td>
            <td><a href="${anime.url}" target="_blank">View</a></td>
        `;
        tbody.appendChild(row);
    });
}

function sortTable(colIndex) {
    const table = document.getElementById("animeTable");
    let switching = true, dir = "asc", switchcount = 0;
    while (switching) {
        switching = false;
        const rows = table.rows;
        for (let i = 1; i < (rows.length - 1); i++) {
            let shouldSwitch = false;
            let x = rows[i].getElementsByTagName("TD")[colIndex];
            let y = rows[i + 1].getElementsByTagName("TD")[colIndex];
            if (dir === "asc" && x.innerHTML.toLowerCase() > y.innerHTML.toLowerCase()) {
                shouldSwitch = true;
            } else if (dir === "desc" && x.innerHTML.toLowerCase() < y.innerHTML.toLowerCase()) {
                shouldSwitch = true;
            }
            if (shouldSwitch) {
                rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
                switching = true;
                switchcount++;
                break;
            }
        }
        if (switchcount === 0 && dir === "asc") {
            dir = "desc";
            switching = true;
        }
    }
}

document.getElementById('search').addEventListener('input', function() {
    const filter = this.value.toLowerCase();
    const rows = document.querySelectorAll('#animeTable tbody tr');
    rows.forEach(row => {
        const text = row.textContent.toLowerCase();
        row.style.display = text.includes(filter) ? '' : 'none';
    });
});

loadAnimeFiles().then(renderTable);
</script>

</body>
</html>
